# AxonTask Configuration
# Copy this file to .env and update with your values

# Database
DATABASE_URL=postgresql://axontask:axontask@localhost:5432/axontask
DATABASE_MAX_CONNECTIONS=10

# Redis
REDIS_URL=redis://localhost:6379
REDIS_MAX_CONNECTIONS=10

# API Server
API_HOST=0.0.0.0
API_PORT=8080

# Production Mode (enables HSTS, strict CORS)
PRODUCTION=false

# JWT Authentication (REQUIRED)
# Generate with: openssl rand -hex 32
JWT_SECRET=your-secret-key-at-least-32-characters-long-generate-with-openssl

# CORS Configuration
# For development: use * (permissive)
# For production: comma-separated list of allowed origins
CORS_ORIGINS=*
# CORS_ORIGINS=https://app.example.com,https://www.example.com

# API Keys
API_KEY_PREFIX=axon_

# HMAC (for webhooks)
HMAC_SECRET=your-hmac-secret-here-generate-with-openssl-rand-base64-32

# Hash Chain & Receipts
RECEIPT_SIGNING_KEY_ED25519=your-ed25519-private-key-hex

# Logging
RUST_LOG=info,axontask_api=debug,axontask_worker=debug,axontask_shared=debug
LOG_FORMAT=json  # json or pretty


# Rate Limits (per plan)
# Trial
TRIAL_TASKS_TOTAL=300
TRIAL_CONCURRENT_TASKS=5
TRIAL_TASK_MINUTES_TOTAL=1500
TRIAL_WS_CONNECTIONS=3
TRIAL_THROUGHPUT_BYTES_PER_SEC=131072
TRIAL_RETENTION_HOURS=24

# Entry ($9.99/mo)
ENTRY_TASKS_PER_DAY=1000
ENTRY_CONCURRENT_TASKS=20
ENTRY_TASK_MINUTES_PER_MONTH=10000
ENTRY_RETENTION_DAYS=7
ENTRY_WEBHOOKS_PER_MIN=10
ENTRY_STREAMS=10

# Pro ($29/mo)
PRO_TASK_MINUTES_PER_MONTH=100000
PRO_CONCURRENT_TASKS=100
PRO_RETENTION_DAYS=30
PRO_WEBHOOKS_PER_MIN=60
PRO_STREAMS=100

# Enterprise
ENT_RETENTION_DAYS=90

# Execution Credits (hourly refill)
CREDITS_REFILL_TRIAL_PER_HOUR=0
CREDITS_REFILL_ENTRY_PER_HOUR=600
CREDITS_REFILL_PRO_PER_HOUR=6000
CREDITS_TASK_COST_BASE=10

# Stream Configuration
STREAM_DIGEST_EVERY_N=50
STREAM_HEARTBEAT_INTERVAL_SECS=25

# Worker Configuration
WORKER_POLL_INTERVAL_MS=1000
WORKER_HEARTBEAT_INTERVAL_SECS=30
WORKER_HEARTBEAT_MISS_THRESHOLD=2
WORKER_COMPACTION_INTERVAL_HOURS=1

# Sandbox Configuration
SANDBOX_MODE=namespaces  # namespaces or microvm
SANDBOX_MAX_CPU_PERCENT=80
SANDBOX_MAX_MEMORY_MB=512
SANDBOX_NETWORK_EGRESS_MB=100

# Stripe (optional - set BILLING_ENABLED=false for self-hosting)
BILLING_ENABLED=false
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...
STRIPE_PUBLISHABLE_KEY=pk_test_...

# Webhook Configuration
WEBHOOK_TIMEOUT_SECS=30
WEBHOOK_MAX_RETRIES=5
WEBHOOK_RETRY_BACKOFF_BASE_MS=1000

# Security
DISABLE_TELEMETRY=false
